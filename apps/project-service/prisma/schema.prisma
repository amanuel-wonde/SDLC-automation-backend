generator client {
    provider = "prisma-client-js"
    output   = "../../../node_modules/@prisma/client-project"
}

datasource db {
    provider = "postgresql"
}

model Project {
    id          String        @id @default(uuid())
    name        String
    description String?
    ownerId     String
    status      ProjectStatus @default(ACTIVE)
    createdAt   DateTime      @default(now())
    updatedAt   DateTime      @updatedAt

    members ProjectMember[]
    tasks   Task[]

    @@map("projects")
}

model ProjectMember {
    id        String     @id @default(uuid())
    projectId String
    userId    String
    role      MemberRole @default(MEMBER)
    joinedAt  DateTime   @default(now())

    project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

    @@unique([projectId, userId])
    @@map("project_members")
}

model Task {
    id           String       @id @default(uuid())
    projectId    String
    title        String
    description  String?
    assignedToId String?
    status       TaskStatus   @default(TODO)
    priority     TaskPriority @default(MEDIUM)
    dueDate      DateTime?
    createdAt    DateTime     @default(now())
    updatedAt    DateTime     @updatedAt

    project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

    @@map("tasks")
}

enum ProjectStatus {
    ACTIVE
    ARCHIVED
    COMPLETED
}

enum MemberRole {
    OWNER
    ADMIN
    MEMBER
    VIEWER
}

enum TaskStatus {
    TODO
    IN_PROGRESS
    DONE
}

enum TaskPriority {
    LOW
    MEDIUM
    HIGH
}
